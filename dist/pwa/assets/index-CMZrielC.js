var ke=Object.defineProperty;var Ge=(i,e,t)=>e in i?ke(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var ne=(i,e,t)=>Ge(i,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function t(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(n){if(n.ep)return;n.ep=!0;const r=t(n);fetch(n.href,r)}})();function A(){}function Se(i){return i()}function me(){return Object.create(null)}function k(i){i.forEach(Se)}function ce(i){return typeof i=="function"}function H(i,e){return i!=i?e==e:i!==e||i&&typeof i=="object"||typeof i=="function"}function Ne(i){return Object.keys(i).length===0}function u(i,e){i.appendChild(e)}function F(i,e,t){i.insertBefore(e,t||null)}function C(i){i.parentNode&&i.parentNode.removeChild(i)}function Z(i,e){for(let t=0;t<i.length;t+=1)i[t]&&i[t].d(e)}function v(i){return document.createElement(i)}function y(i){return document.createTextNode(i)}function b(){return y(" ")}function xe(){return y("")}function P(i,e,t,s){return i.addEventListener(e,t,s),()=>i.removeEventListener(e,t,s)}function m(i,e,t){t==null?i.removeAttribute(e):i.getAttribute(e)!==t&&i.setAttribute(e,t)}function Me(i){return Array.from(i.childNodes)}function X(i,e){e=""+e,i.data!==e&&(i.data=e)}function le(i,e){i.value=e??""}function oe(i,e,t,s){t==null?i.style.removeProperty(e):i.style.setProperty(e,t,"")}function te(i,e,t){for(let s=0;s<i.options.length;s+=1){const n=i.options[s];if(n.__value===e){n.selected=!0;return}}(!t||e!==void 0)&&(i.selectedIndex=-1)}function Ie(i){const e=i.querySelector(":checked");return e&&e.__value}function ve(i,e,t){i.classList.toggle(e,!!t)}function Xe(i,e,{bubbles:t=!1,cancelable:s=!1}={}){return new CustomEvent(i,{detail:e,bubbles:t,cancelable:s})}let O;function M(i){O=i}function fe(){if(!O)throw new Error("Function called outside component initialization");return O}function $e(i){fe().$$.on_mount.push(i)}function Oe(i){fe().$$.on_destroy.push(i)}function he(){const i=fe();return(e,t,{cancelable:s=!1}={})=>{const n=i.$$.callbacks[e];if(n){const r=Xe(e,t,{cancelable:s});return n.slice().forEach(l=>{l.call(i,r)}),!r.defaultPrevented}return!0}}const L=[],z=[];let U=[];const _e=[],ze=Promise.resolve();let ae=!1;function We(){ae||(ae=!0,ze.then(De))}function W(i){U.push(i)}const re=new Set;let D=0;function De(){if(D!==0)return;const i=O;do{try{for(;D<L.length;){const e=L[D];D++,M(e),He(e.$$)}}catch(e){throw L.length=0,D=0,e}for(M(null),L.length=0,D=0;z.length;)z.pop()();for(let e=0;e<U.length;e+=1){const t=U[e];re.has(t)||(re.add(t),t())}U.length=0}while(L.length);for(;_e.length;)_e.pop()();ae=!1,re.clear(),M(i)}function He(i){if(i.fragment!==null){i.update(),k(i.before_update);const e=i.dirty;i.dirty=[-1],i.fragment&&i.fragment.p(i.ctx,e),i.after_update.forEach(W)}}function Ye(i){const e=[],t=[];U.forEach(s=>i.indexOf(s)===-1?e.push(s):t.push(s)),t.forEach(s=>s()),U=e}const ee=new Set;let je;function G(i,e){i&&i.i&&(ee.delete(i),i.i(e))}function J(i,e,t,s){if(i&&i.o){if(ee.has(i))return;ee.add(i),je.c.push(()=>{ee.delete(i)}),i.o(e)}}function B(i){return(i==null?void 0:i.length)!==void 0?i:Array.from(i)}function Q(i){i&&i.c()}function N(i,e,t){const{fragment:s,after_update:n}=i.$$;s&&s.m(e,t),W(()=>{const r=i.$$.on_mount.map(Se).filter(ce);i.$$.on_destroy?i.$$.on_destroy.push(...r):k(r),i.$$.on_mount=[]}),n.forEach(W)}function x(i,e){const t=i.$$;t.fragment!==null&&(Ye(t.after_update),k(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function Ve(i,e){i.$$.dirty[0]===-1&&(L.push(i),We(),i.$$.dirty.fill(0)),i.$$.dirty[e/31|0]|=1<<e%31}function Y(i,e,t,s,n,r,l=null,f=[-1]){const d=O;M(i);const o=i.$$={fragment:null,ctx:[],props:r,update:A,not_equal:n,bound:me(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(d?d.$$.context:[])),callbacks:me(),dirty:f,skip_bound:!1,root:e.target||d.$$.root};l&&l(o.root);let h=!1;if(o.ctx=t?t(i,e.props||{},(g,p,...w)=>{const E=w.length?w[0]:p;return o.ctx&&n(o.ctx[g],o.ctx[g]=E)&&(!o.skip_bound&&o.bound[g]&&o.bound[g](E),h&&Ve(i,g)),p}):[],o.update(),h=!0,k(o.before_update),o.fragment=s?s(o.ctx):!1,e.target){if(e.hydrate){const g=Me(e.target);o.fragment&&o.fragment.l(g),g.forEach(C)}else o.fragment&&o.fragment.c();e.intro&&G(i.$$.fragment),N(i,e.target,e.anchor),De()}M(d)}class j{constructor(){ne(this,"$$");ne(this,"$$set")}$destroy(){x(this,1),this.$destroy=A}$on(e,t){if(!ce(t))return A;const s=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return s.push(t),()=>{const n=s.indexOf(t);n!==-1&&s.splice(n,1)}}$set(e){this.$$set&&!Ne(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const qe="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(qe);class Ke{constructor(e){this.gl=null,this.program=null,this.positionBuffer=null,this.texCoordBuffer=null,this.texture=null,this.framebuffer=null,this.outputTexture=null,this.width=0,this.height=0,this.canvas=e||document.createElement("canvas"),this.initWebGL()}initWebGL(){if(this.gl=this.canvas.getContext("webgl")||this.canvas.getContext("experimental-webgl"),!this.gl)throw new Error("WebGL not supported");const e=this.createShader(this.gl.VERTEX_SHADER,`
      attribute vec2 a_position;
      attribute vec2 a_texCoord;
      varying vec2 v_texCoord;
      
      void main() {
        gl_Position = vec4(a_position, 0, 1);
        v_texCoord = a_texCoord;
      }
    `),t=this.createShader(this.gl.FRAGMENT_SHADER,`
      precision mediump float;
      uniform sampler2D u_image;
      varying vec2 v_texCoord;
      
      void main() {
        gl_FragColor = texture2D(u_image, v_texCoord);
      }
    `);this.program=this.createProgram(e,t),this.positionBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,1,1]),this.gl.STATIC_DRAW),this.texCoordBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.texCoordBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,1,1]),this.gl.STATIC_DRAW),this.texture=this.gl.createTexture(),this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.framebuffer=this.gl.createFramebuffer(),this.outputTexture=this.gl.createTexture()}createShader(e,t){if(!this.gl)throw new Error("WebGL not initialized");const s=this.gl.createShader(e);if(!s)throw new Error("Failed to create shader");if(this.gl.shaderSource(s,t),this.gl.compileShader(s),!this.gl.getShaderParameter(s,this.gl.COMPILE_STATUS)){const r=this.gl.getShaderInfoLog(s);throw this.gl.deleteShader(s),new Error("Failed to compile shader: "+r)}return s}createProgram(e,t){if(!this.gl)throw new Error("WebGL not initialized");const s=this.gl.createProgram();if(!s)throw new Error("Failed to create program");if(this.gl.attachShader(s,e),this.gl.attachShader(s,t),this.gl.linkProgram(s),!this.gl.getProgramParameter(s,this.gl.LINK_STATUS)){const r=this.gl.getProgramInfoLog(s);throw this.gl.deleteProgram(s),new Error("Failed to link program: "+r)}return s}setSize(e,t){this.width=e,this.height=t,this.canvas.width=e,this.canvas.height=t,!(!this.gl||!this.outputTexture)&&(this.gl.bindTexture(this.gl.TEXTURE_2D,this.outputTexture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,e,t,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,null),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.viewport(0,0,e,t))}render(e){if(!this.gl||!this.program||!this.texture||!this.framebuffer||!this.outputTexture)throw new Error("WebGL resources not initialized");let t=0,s=0;e instanceof HTMLVideoElement?(t=e.videoWidth,s=e.videoHeight):(e instanceof HTMLCanvasElement||e instanceof ImageBitmap||e instanceof ImageData)&&(t=e.width,s=e.height),(t!==this.width||s!==this.height)&&this.setSize(t,s),this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),e instanceof ImageData?this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,t,s,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,new Uint8Array(e.data.buffer)):this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,e),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.framebuffer),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,this.outputTexture,0),this.gl.useProgram(this.program);const n=this.gl.getAttribLocation(this.program,"a_position"),r=this.gl.getAttribLocation(this.program,"a_texCoord");this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionBuffer),this.gl.enableVertexAttribArray(n),this.gl.vertexAttribPointer(n,2,this.gl.FLOAT,!1,0,0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.texCoordBuffer),this.gl.enableVertexAttribArray(r),this.gl.vertexAttribPointer(r,2,this.gl.FLOAT,!1,0,0);const l=this.gl.getUniformLocation(this.program,"u_image");this.gl.uniform1i(l,0),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4);const f=new Uint8Array(this.width*this.height*4);return this.gl.readPixels(0,0,this.width,this.height,this.gl.RGBA,this.gl.UNSIGNED_BYTE,f),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),new ImageData(new Uint8ClampedArray(f.buffer),this.width,this.height)}setFragmentShader(e){if(!this.gl)throw new Error("WebGL not initialized");const t=this.createShader(this.gl.VERTEX_SHADER,`
      attribute vec2 a_position;
      attribute vec2 a_texCoord;
      varying vec2 v_texCoord;
      
      void main() {
        gl_Position = vec4(a_position, 0, 1);
        v_texCoord = a_texCoord;
      }
    `),s=this.createShader(this.gl.FRAGMENT_SHADER,e),n=this.createProgram(t,s);this.program&&this.gl.deleteProgram(this.program),this.program=n}getCanvas(){return this.canvas}dispose(){this.gl&&(this.program&&(this.gl.deleteProgram(this.program),this.program=null),this.positionBuffer&&(this.gl.deleteBuffer(this.positionBuffer),this.positionBuffer=null),this.texCoordBuffer&&(this.gl.deleteBuffer(this.texCoordBuffer),this.texCoordBuffer=null),this.texture&&(this.gl.deleteTexture(this.texture),this.texture=null),this.outputTexture&&(this.gl.deleteTexture(this.outputTexture),this.outputTexture=null),this.framebuffer&&(this.gl.deleteFramebuffer(this.framebuffer),this.framebuffer=null),this.gl=null)}}class Je{constructor(e={}){this.isRunning=!1,this.animationFrameId=0,this.lastFrameTime=0,this.frameCount=0,this.fps=0,this.stream=null,this.options={width:e.width||640,height:e.height||480,frameRate:e.frameRate||30,initialEffect:e.initialEffect||null,canvas:e.canvas||document.createElement("canvas"),video:e.video||document.createElement("video")},this.canvas=this.options.canvas,this.canvas.width=this.options.width,this.canvas.height=this.options.height,this.video=this.options.video,this.video.width=this.options.width,this.video.height=this.options.height,this.video.autoplay=!0,this.video.muted=!0,this.video.playsInline=!0,this.renderer=new Ke(this.canvas),this.renderer.setSize(this.options.width,this.options.height),this.currentEffect=this.options.initialEffect}async start(e){if(!this.isRunning)try{const t={video:e?{deviceId:{exact:e}}:{width:{ideal:this.options.width},height:{ideal:this.options.height},frameRate:{ideal:this.options.frameRate}},audio:!1};this.stream=await navigator.mediaDevices.getUserMedia(t),this.video.srcObject=this.stream,await new Promise(s=>{this.video.onloadedmetadata=()=>{this.video.play().then(()=>s())}}),this.isRunning=!0,this.lastFrameTime=performance.now(),this.frameCount=0,this.renderFrame()}catch(t){throw console.error("Error starting video:",t),t}}stop(){this.isRunning&&(this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=0),this.stream&&(this.stream.getTracks().forEach(e=>e.stop()),this.stream=null),this.video.srcObject=null,this.isRunning=!1)}renderFrame(){if(!this.isRunning)return;const e=performance.now(),t=e-this.lastFrameTime;this.frameCount++,t>=1e3&&(this.fps=this.frameCount*1e3/t,this.lastFrameTime=e,this.frameCount=0);try{const s=this.renderer.render(this.video);if(this.currentEffect){const n=this.currentEffect.transform(s),r=this.canvas.getContext("2d");r&&r.putImageData(n,0,0)}this.drawFPS()}catch(s){console.error("Error rendering frame:",s)}this.animationFrameId=requestAnimationFrame(()=>this.renderFrame())}drawFPS(){const e=this.canvas.getContext("2d");if(!e)return;e.font="16px Arial",e.fillStyle="white",e.strokeStyle="black",e.lineWidth=2;const t=`FPS: ${this.fps.toFixed(1)}`;e.strokeText(t,10,20),e.fillText(t,10,20)}setEffect(e){this.currentEffect=e,this.currentEffect&&this.currentEffect.reset()}getEffect(){return this.currentEffect}getFPS(){return this.fps}getCanvas(){return this.canvas}getVideo(){return this.video}static async getVideoDevices(){try{return await navigator.mediaDevices.getUserMedia({video:!0}),(await navigator.mediaDevices.enumerateDevices()).filter(t=>t.kind==="videoinput")}catch(e){return console.error("Error getting video devices:",e),[]}}takeSnapshot(){return this.canvas.toDataURL("image/png")}dispose(){this.stop(),this.renderer.dispose()}}class ie{constructor(e,t){this.name=e||this.constructor.name,this.description=t||""}encode(e){return e}decode(e){return e}filter(e){return e}reset(){}validateImageData(e,t,s){if(!(e instanceof ImageData))throw new Error("Input must be an ImageData object");if(t!==void 0&&e.width!==t)throw new Error(`ImageData must have width ${t}, got ${e.width}`);if(s!==void 0&&e.height!==s)throw new Error(`ImageData must have height ${s}, got ${e.height}`);return e}}class Qe extends ie{constructor(){super("Prime RGB","Transforms RGB values to the nearest prime numbers, creating a distinctive color shift."),this.primeLookup=this.precomputeNearestPrimes(255)}transform(e){this.validateImageData(e);const t=new ImageData(e.width,e.height),s=e.data,n=t.data;for(let r=0;r<s.length;r+=4)n[r]=this.primeLookup[s[r]],n[r+1]=this.primeLookup[s[r+1]],n[r+2]=this.primeLookup[s[r+2]],n[r+3]=s[r+3];return t}precomputeNearestPrimes(e){const t=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251],s=new Uint8Array(e+1);for(let n=0;n<=e;n++){let r=t[0],l=Math.abs(r-n);for(let f=1;f<t.length;f++){const d=Math.abs(t[f]-n);d<l&&(l=d,r=t[f])}s[n]=r}return s}}class Ze extends ie{constructor(){super("Fibonacci RGB","Transforms RGB values to the nearest Fibonacci numbers, creating a distinctive color shift."),this.fibonacciLookup=this.precomputeNearestFibonacci(255)}transform(e){this.validateImageData(e);const t=new ImageData(e.width,e.height),s=e.data,n=t.data;for(let r=0;r<s.length;r+=4)n[r]=this.fibonacciLookup[s[r]],n[r+1]=this.fibonacciLookup[s[r+1]],n[r+2]=this.fibonacciLookup[s[r+2]],n[r+3]=s[r+3];return t}precomputeNearestFibonacci(e){const t=[0,1];for(;t[t.length-1]+t[t.length-2]<=e;)t.push(t[t.length-1]+t[t.length-2]);const s=new Uint8Array(e+1);for(let n=0;n<=e;n++){let r=t[0],l=Math.abs(r-n);for(let f=1;f<t.length;f++){const d=Math.abs(t[f]-n);d<l&&(l=d,r=t[f])}s[n]=r}return s}}class et extends ie{constructor(){super("Color Negative","Inverts the colors of an image by subtracting each RGB component from 255.")}transform(e){this.validateImageData(e);const t=new ImageData(e.width,e.height),s=e.data,n=t.data;for(let r=0;r<s.length;r+=4)n[r]=255-s[r],n[r+1]=255-s[r+1],n[r+2]=255-s[r+2],n[r+3]=s[r+3];return t}}class tt extends ie{constructor(){super("Middle Four Bits","Extracts the middle 4 bits from each RGB component, creating a posterized effect.")}transform(e){this.validateImageData(e);const t=new ImageData(e.width,e.height),s=e.data,n=t.data;for(let r=0;r<s.length;r+=4)n[r]=(s[r]>>2&15)*16,n[r+1]=(s[r+1]>>2&15)*16,n[r+2]=(s[r+2]>>2&15)*16,n[r+3]=s[r+3];return t}}function Ee(i){let e,t,s,n,r,l,f,d;return{c(){e=v("div"),t=v("p"),s=y("‚ö†Ô∏è "),n=y(i[5]),r=b(),l=v("button"),l.textContent="Retry",m(t,"class","svelte-w1rruh"),m(l,"class","svelte-w1rruh"),m(e,"class","error-overlay svelte-w1rruh")},m(o,h){F(o,e,h),u(e,t),u(t,s),u(t,n),u(e,r),u(e,l),f||(d=P(l,"click",i[0]),f=!0)},p(o,h){h&32&&X(n,o[5])},d(o){o&&C(e),f=!1,d()}}}function be(i){let e,t,s,n;return{c(){e=v("div"),t=v("button"),t.innerHTML=`<span class="icon svelte-w1rruh">‚ñ∂</span>
          Start Camera`,m(t,"class","start-button svelte-w1rruh"),m(e,"class","start-overlay svelte-w1rruh")},m(r,l){F(r,e,l),u(e,t),s||(n=P(t,"click",i[0]),s=!0)},p:A,d(r){r&&C(e),s=!1,n()}}}function it(i){let e,t,s,n,r,l,f,d,o,h,g=i[4]?"‚è∏ Pause":"‚ñ∂ Play",p,w,E,c=i[5]&&Ee(i),_=!i[4]&&!i[5]&&be(i);return{c(){e=v("div"),t=v("div"),s=v("canvas"),n=b(),r=v("video"),l=b(),c&&c.c(),f=b(),_&&_.c(),d=b(),o=v("div"),h=v("button"),p=y(g),m(s,"width","640"),m(s,"height","480"),m(s,"class","svelte-w1rruh"),oe(r,"display","none"),m(t,"class","video-container svelte-w1rruh"),m(h,"class","control-btn svelte-w1rruh"),m(o,"class","controls svelte-w1rruh"),m(e,"class","video-player svelte-w1rruh")},m(a,R){F(a,e,R),u(e,t),u(t,s),i[8](s),u(t,n),u(t,r),i[9](r),u(t,l),c&&c.m(t,null),u(t,f),_&&_.m(t,null),u(e,d),u(e,o),u(o,h),u(h,p),w||(E=P(h,"click",function(){ce(i[4]?i[1]:i[0])&&(i[4]?i[1]:i[0]).apply(this,arguments)}),w=!0)},p(a,[R]){i=a,i[5]?c?c.p(i,R):(c=Ee(i),c.c(),c.m(t,f)):c&&(c.d(1),c=null),!i[4]&&!i[5]?_?_.p(i,R):(_=be(i),_.c(),_.m(t,null)):_&&(_.d(1),_=null),R&16&&g!==(g=i[4]?"‚è∏ Pause":"‚ñ∂ Play")&&X(p,g)},i:A,o:A,d(a){a&&C(e),i[8](null),i[9](null),c&&c.d(),_&&_.d(),w=!1,E()}}}function st(i,e,t){const s=he();let n,r,l=null,f=!1,d=null,o;const h={None:null,"Color Negative":new et,"Prime RGB":new Qe,"Fibonacci RGB":new Ze,"Middle 4-Bit":new tt};async function g(){if(!f)try{t(5,d=null),l=new Je({canvas:n,video:r,width:640,height:480,frameRate:30}),await l.start(),t(4,f=!0),s("playing",!0),o=window.setInterval(()=>{l&&s("stats",{fps:l.getFPS()})},1e3)}catch(a){t(5,d=a instanceof Error?a.message:"Failed to start camera"),console.error("Error starting video:",a)}}async function p(){f&&(l&&(l.stop(),l=null),t(4,f=!1),s("playing",!1),o&&clearInterval(o))}function w(a){l&&a in h&&l.setEffect(h[a])}async function E(a){const R=f;R&&await p(),R&&await g()}$e(()=>{g()}),Oe(()=>{p()});function c(a){z[a?"unshift":"push"](()=>{n=a,t(2,n)})}function _(a){z[a?"unshift":"push"](()=>{r=a,t(3,r)})}return[g,p,n,r,f,d,w,E,c,_]}class nt extends j{constructor(e){super(),Y(this,e,st,it,H,{start:0,stop:1,setEffect:6,setCamera:7})}get start(){return this.$$.ctx[0]}get stop(){return this.$$.ctx[1]}get setEffect(){return this.$$.ctx[6]}get setCamera(){return this.$$.ctx[7]}}function we(i,e,t){const s=i.slice();return s[6]=e[t],s}function Re(i,e,t){const s=i.slice();return s[6]=e[t],s}function Te(i,e,t){const s=i.slice();return s[6]=e[t],s}function Ce(i){let e,t=i[6].label+"",s;return{c(){e=v("option"),s=y(t),e.__value=i[6].value,le(e,e.__value),m(e,"class","svelte-149gm58")},m(n,r){F(n,e,r),u(e,s)},p:A,d(n){n&&C(e)}}}function Fe(i){let e;return{c(){e=v("p"),e.textContent=`${i[6].description}`,m(e,"class","description svelte-149gm58")},m(t,s){F(t,e,s)},p:A,d(t){t&&C(e)}}}function Ae(i){let e,t=i[6].value===i[0]&&Fe(i);return{c(){t&&t.c(),e=xe()},m(s,n){t&&t.m(s,n),F(s,e,n)},p(s,n){s[6].value===s[0]?t?t.p(s,n):(t=Fe(s),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(s){s&&C(e),t&&t.d(s)}}}function ye(i){let e,t,s,n,r,l,f;function d(){return i[5](i[6])}return{c(){e=v("button"),t=v("div"),t.textContent=`${i[6].label}`,s=b(),n=v("div"),n.textContent=`${i[6].description}`,r=b(),m(t,"class","effect-name svelte-149gm58"),m(n,"class","effect-desc svelte-149gm58"),m(e,"class","effect-card svelte-149gm58"),ve(e,"active",i[6].value===i[0])},m(o,h){F(o,e,h),u(e,t),u(e,s),u(e,n),u(e,r),l||(f=P(e,"click",d),l=!0)},p(o,h){i=o,h&5&&ve(e,"active",i[6].value===i[0])},d(o){o&&C(e),l=!1,f()}}}function rt(i){let e,t,s,n,r,l,f,d,o=B(i[2]),h=[];for(let c=0;c<o.length;c+=1)h[c]=Ce(Te(i,o,c));let g=B(i[2]),p=[];for(let c=0;c<g.length;c+=1)p[c]=Ae(Re(i,g,c));let w=B(i[2]),E=[];for(let c=0;c<w.length;c+=1)E[c]=ye(we(i,w,c));return{c(){e=v("div"),t=v("select");for(let c=0;c<h.length;c+=1)h[c].c();s=b(),n=v("div");for(let c=0;c<p.length;c+=1)p[c].c();r=b(),l=v("div");for(let c=0;c<E.length;c+=1)E[c].c();m(t,"class","svelte-149gm58"),i[0]===void 0&&W(()=>i[4].call(t)),m(n,"class","effect-info svelte-149gm58"),m(l,"class","effect-grid svelte-149gm58"),m(e,"class","effect-selector svelte-149gm58")},m(c,_){F(c,e,_),u(e,t);for(let a=0;a<h.length;a+=1)h[a]&&h[a].m(t,null);te(t,i[0],!0),u(e,s),u(e,n);for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(n,null);u(e,r),u(e,l);for(let a=0;a<E.length;a+=1)E[a]&&E[a].m(l,null);f||(d=[P(t,"change",i[4]),P(t,"change",i[3])],f=!0)},p(c,[_]){if(_&4){o=B(c[2]);let a;for(a=0;a<o.length;a+=1){const R=Te(c,o,a);h[a]?h[a].p(R,_):(h[a]=Ce(R),h[a].c(),h[a].m(t,null))}for(;a<h.length;a+=1)h[a].d(1);h.length=o.length}if(_&5&&te(t,c[0]),_&5){g=B(c[2]);let a;for(a=0;a<g.length;a+=1){const R=Re(c,g,a);p[a]?p[a].p(R,_):(p[a]=Ae(R),p[a].c(),p[a].m(n,null))}for(;a<p.length;a+=1)p[a].d(1);p.length=g.length}if(_&7){w=B(c[2]);let a;for(a=0;a<w.length;a+=1){const R=we(c,w,a);E[a]?E[a].p(R,_):(E[a]=ye(R),E[a].c(),E[a].m(l,null))}for(;a<E.length;a+=1)E[a].d(1);E.length=w.length}},i:A,o:A,d(c){c&&C(e),Z(h,c),Z(p,c),Z(E,c),f=!1,k(d)}}}function lt(i,e,t){const s=he();let{currentEffect:n="None"}=e;const r=[{value:"None",label:"None",description:"No effect applied"},{value:"Color Negative",label:"Color Negative",description:"Inverts all RGB values"},{value:"Prime RGB",label:"Prime RGB",description:"Rounds RGB to nearest prime numbers"},{value:"Fibonacci RGB",label:"Fibonacci RGB",description:"Rounds RGB to Fibonacci sequence"},{value:"Middle 4-Bit",label:"Middle 4-Bit",description:"Preserves middle 4 bits only"}];function l(o){const h=o.target;t(0,n=h.value),s("change",n)}function f(){n=Ie(this),t(0,n),t(2,r)}const d=o=>{t(0,n=o.value),s("change",n)};return i.$$set=o=>{"currentEffect"in o&&t(0,n=o.currentEffect)},[n,s,r,l,f,d]}class ot extends j{constructor(e){super(),Y(this,e,lt,rt,H,{currentEffect:0})}}function Pe(i,e,t){const s=i.slice();return s[8]=e[t],s}function at(i){let e,t,s,n,r,l,f=B(i[1]),d=[];for(let o=0;o<f.length;o+=1)d[o]=Be(Pe(i,f,o));return{c(){e=v("select");for(let o=0;o<d.length;o+=1)d[o].c();t=b(),s=v("button"),n=y("üîÑ Refresh"),e.disabled=i[0],m(e,"class","svelte-cuhhxz"),i[2]===void 0&&W(()=>i[6].call(e)),m(s,"class","refresh-btn svelte-cuhhxz"),s.disabled=i[0]},m(o,h){F(o,e,h);for(let g=0;g<d.length;g+=1)d[g]&&d[g].m(e,null);te(e,i[2],!0),F(o,t,h),F(o,s,h),u(s,n),r||(l=[P(e,"change",i[6]),P(e,"change",i[5]),P(s,"click",i[4])],r=!0)},p(o,h){if(h&2){f=B(o[1]);let g;for(g=0;g<f.length;g+=1){const p=Pe(o,f,g);d[g]?d[g].p(p,h):(d[g]=Be(p),d[g].c(),d[g].m(e,null))}for(;g<d.length;g+=1)d[g].d(1);d.length=f.length}h&1&&(e.disabled=o[0]),h&6&&te(e,o[2]),h&1&&(s.disabled=o[0])},d(o){o&&(C(e),C(t),C(s)),Z(d,o),r=!1,k(l)}}}function ct(i){let e;return{c(){e=v("div"),e.textContent="No cameras found",m(e,"class","no-cameras svelte-cuhhxz")},m(t,s){F(t,e,s)},p:A,d(t){t&&C(e)}}}function ft(i){let e;return{c(){e=v("div"),e.textContent="Loading cameras...",m(e,"class","loading svelte-cuhhxz")},m(t,s){F(t,e,s)},p:A,d(t){t&&C(e)}}}function Be(i){let e,t=(i[8].label||`Camera ${i[1].indexOf(i[8])+1}`)+"",s,n,r;return{c(){e=v("option"),s=y(t),n=b(),e.__value=r=i[8].deviceId,le(e,e.__value),m(e,"class","svelte-cuhhxz")},m(l,f){F(l,e,f),u(e,s),u(e,n)},p(l,f){f&2&&t!==(t=(l[8].label||`Camera ${l[1].indexOf(l[8])+1}`)+"")&&X(s,t),f&2&&r!==(r=l[8].deviceId)&&(e.__value=r,le(e,e.__value))},d(l){l&&C(e)}}}function ht(i){let e;function t(r,l){return r[3]?ft:r[1].length===0?ct:at}let s=t(i),n=s(i);return{c(){e=v("div"),n.c(),m(e,"class","camera-selector svelte-cuhhxz")},m(r,l){F(r,e,l),n.m(e,null)},p(r,[l]){s===(s=t(r))&&n?n.p(r,l):(n.d(1),n=s(r),n&&(n.c(),n.m(e,null)))},i:A,o:A,d(r){r&&C(e),n.d()}}}function ut(i,e,t){const s=he();let{disabled:n=!1}=e,r=[],l="",f=!0;async function d(){try{t(3,f=!0);const g=await navigator.mediaDevices.enumerateDevices();t(1,r=g.filter(p=>p.kind==="videoinput")),r.length>0&&!l&&t(2,l=r[0].deviceId)}catch(g){console.error("Error loading cameras:",g)}finally{t(3,f=!1)}}function o(g){const p=g.target;t(2,l=p.value),s("change",l)}$e(()=>{d()});function h(){l=Ie(this),t(2,l),t(1,r)}return i.$$set=g=>{"disabled"in g&&t(0,n=g.disabled)},[n,r,l,f,d,o,h]}class dt extends j{constructor(e){super(),Y(this,e,ut,ht,H,{disabled:0})}}function gt(i){let e,t,s,n,r,l=i[0].toFixed(1)+"",f,d,o,h,g,p,w,E,c;return{c(){e=v("div"),t=v("div"),s=v("div"),s.textContent="FPS",n=b(),r=v("div"),f=y(l),d=b(),o=v("div"),h=v("div"),h.textContent="Current Effect",g=b(),p=v("div"),w=y(i[1]),E=b(),c=v("div"),c.innerHTML='<div class="stat-label svelte-17o8ne9">Resolution</div> <div class="stat-value svelte-17o8ne9">640 √ó 480</div>',m(s,"class","stat-label svelte-17o8ne9"),m(r,"class","stat-value svelte-17o8ne9"),oe(r,"color",i[2]),m(t,"class","stat-item svelte-17o8ne9"),m(h,"class","stat-label svelte-17o8ne9"),m(p,"class","stat-value effect-name svelte-17o8ne9"),m(o,"class","stat-item svelte-17o8ne9"),m(c,"class","stat-item svelte-17o8ne9"),m(e,"class","stats svelte-17o8ne9")},m(_,a){F(_,e,a),u(e,t),u(t,s),u(t,n),u(t,r),u(r,f),u(e,d),u(e,o),u(o,h),u(o,g),u(o,p),u(p,w),u(e,E),u(e,c)},p(_,[a]){a&1&&l!==(l=_[0].toFixed(1)+"")&&X(f,l),a&4&&oe(r,"color",_[2]),a&2&&X(w,_[1])},i:A,o:A,d(_){_&&C(e)}}}function pt(i,e,t){let s,{fps:n=0}=e,{effect:r="None"}=e;return i.$$set=l=>{"fps"in l&&t(0,n=l.fps),"effect"in l&&t(1,r=l.effect)},i.$$.update=()=>{i.$$.dirty&1&&t(2,s=n>=25?"#4ade80":n>=15?"#fbbf24":"#ef4444")},[n,r,s]}class mt extends j{constructor(e){super(),Y(this,e,pt,gt,H,{fps:0,effect:1})}}function vt(i){let e,t,s,n,r,l,f,d,o,h,g,p,w,E,c,_,a,R,I,V,ue,S,de,q,K,Le={};return l=new nt({props:Le}),i[8](l),l.$on("stats",i[6]),l.$on("playing",i[7]),p=new dt({props:{disabled:i[3]}}),p.$on("change",i[5]),a=new ot({props:{currentEffect:i[1]}}),a.$on("change",i[4]),S=new mt({props:{fps:i[2],effect:i[1]}}),{c(){e=v("main"),t=v("header"),t.innerHTML='<h1 class="svelte-15l34pn">üé• PF-Compression Showcase</h1> <p class="svelte-15l34pn">Real-time webcam effects using novel compression algorithms</p>',s=b(),n=v("div"),r=v("div"),Q(l.$$.fragment),f=b(),d=v("div"),o=v("div"),h=v("h3"),h.textContent="Camera",g=b(),Q(p.$$.fragment),w=b(),E=v("div"),c=v("h3"),c.textContent="Effect",_=b(),Q(a.$$.fragment),R=b(),I=v("div"),V=v("h3"),V.textContent="Stats",ue=b(),Q(S.$$.fragment),de=b(),q=v("footer"),q.innerHTML=`<p>Built with Svelte + TypeScript | 
      <a href="https://github.com/Senneseph/PF-Compression" target="_blank" rel="noopener" class="svelte-15l34pn">View on GitHub</a></p>`,m(t,"class","svelte-15l34pn"),m(r,"class","video-section svelte-15l34pn"),m(h,"class","svelte-15l34pn"),m(o,"class","control-group svelte-15l34pn"),m(c,"class","svelte-15l34pn"),m(E,"class","control-group svelte-15l34pn"),m(V,"class","svelte-15l34pn"),m(I,"class","control-group svelte-15l34pn"),m(d,"class","controls-section svelte-15l34pn"),m(n,"class","container svelte-15l34pn"),m(q,"class","svelte-15l34pn"),m(e,"class","svelte-15l34pn")},m(T,$){F(T,e,$),u(e,t),u(e,s),u(e,n),u(n,r),N(l,r,null),u(n,f),u(n,d),u(d,o),u(o,h),u(o,g),N(p,o,null),u(d,w),u(d,E),u(E,c),u(E,_),N(a,E,null),u(d,R),u(d,I),u(I,V),u(I,ue),N(S,I,null),u(e,de),u(e,q),K=!0},p(T,[$]){const Ue={};l.$set(Ue);const ge={};$&8&&(ge.disabled=T[3]),p.$set(ge);const pe={};$&2&&(pe.currentEffect=T[1]),a.$set(pe);const se={};$&4&&(se.fps=T[2]),$&2&&(se.effect=T[1]),S.$set(se)},i(T){K||(G(l.$$.fragment,T),G(p.$$.fragment,T),G(a.$$.fragment,T),G(S.$$.fragment,T),K=!0)},o(T){J(l.$$.fragment,T),J(p.$$.fragment,T),J(a.$$.fragment,T),J(S.$$.fragment,T),K=!1},d(T){T&&C(e),i[8](null),x(l),x(p),x(a),x(S)}}}function _t(i,e,t){let s,n="None",r=0,l=!1;function f(p){t(1,n=p.detail),s&&s.setEffect(n)}function d(p){s&&s.setCamera(p.detail)}function o(p){t(2,r=p.detail.fps)}function h(p){t(3,l=p.detail)}function g(p){z[p?"unshift":"push"](()=>{s=p,t(0,s)})}return[s,n,r,l,f,d,o,h,g]}class Et extends j{constructor(e){super(),Y(this,e,_t,vt,H,{})}}new Et({target:document.getElementById("app")});
